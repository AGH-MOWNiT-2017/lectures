\section{Podstawowe metody bezpośredniego rozwiązywania Ax=b}
	\begin{frame}{Wstęp}
\begin{exampleblock}{}
    $$
E_{1}:a_{11}x_{1}+a_{12}x_{2}+\cdots+a_{1n}x_{n}=b_{1}
$$
$$
\hspace{55.5mm} \vdots
$$
$$
E_{n}:a_{n1}x_{1}+a_{n2}x_{2}+\cdots+a_{nn}x_{n}=b_{n}
$$

 \end{exampleblock}
Podstawa metod bezpośrednich: operacje te nie zmieniają rozwiązań układów równań.
\begin{flushright}
{\it Zadanie}: Sprawdzić
\end{flushright} 
	\end{frame}
    \begin{frame}{}
    $\bullet(\lambda E_{i})\rightarrow E_{i}$

$\bullet(E_{i}+\lambda E_{j})\rightarrow E_{i}$

$\bullet E_{i}\leftrightarrow E_{i}$ \newline
gdzie $\lambda$ -stała różna od zera \newline
Celem jest uzyskanie postaci: (triangular or reduced form)
\begin{flushright}
$a_{11}x_{1}+a_{12}x_{2}+\cdots+a_{1n}x_{n}=b_{1} \linebreak$

$0+a_{22}'x_{2}+\cdots+a_{2n}'x_{n}=b_{2}'
 \linebreak$
$ \hspace{60mm} \vdots \linebreak$
$0+\cdots+0+a_{nn}'n_{n}=b_{n}' \linebreak$
\end{flushright}
$\mathrm{i}$ wtedy

$x_{n}=b_{n}'/a_{nn}' x_{i}=(b_{i}'-\displaystyle \sum_{j=i+1}^{n})a_{ij}'x_{j}/a_{ii}'$ (via backward substitution)
    \end{frame}
\begin{frame}{Gaussian elimination with backward substitution}

\begin{exampleblock}{Elimination}
for $\mathrm{i}:=1$ to n-1 do

\hspace{4mm} begin

\hspace{7mm} $\mathrm{p}:=$smallest integer $in[i,\ n]$ : $a_{pi}\neq 0$; /szukanie w i-tej 
\hspace*{7mm} kolumnie/ \newline
\hspace*{7mm} if no $\mathrm{p}$ then no unique solution exist!; STOP;

\hspace{7mm} if $p\neq i$ then $E_{p}\leftrightarrow E_{i}$ /przestawienie/

\hspace{7mm} for $\mathrm{j}:=\mathrm{i}+1$ to $\mathrm{n}$ do $(E_{j}-\displaystyle \frac{aji}{aE}\rightarrow E_{j}$

\hspace{4mm} end

if $a_{nn}=0$ then no unique solution exist!; STOP;
    	\end{exampleblock}

\end{frame}

\begin{frame}{Gaussian elimination with backward substitution}
\begin{exampleblock}{Backward substitution}
$x_{n}=b_{n}'/a_{nn}'$;

for $\mathrm{i}:=\mathrm{n}-1$ downto 1 do $x_{i}=(b_{i}-\displaystyle \sum_{j=i+1}^{n}a_{ij}x_{j})/a_{ii}$;
\end{exampleblock}

\begin{itemize}
\item \textbf{Złożoność obiczeniowa}

Liczba dziala\'{n} mnozenia $\mathrm{i}$ dzielenia wynosi $\displaystyle \frac{1}{3}\cdot(n^{3}+3n^{2}-n)$

Liczba dziala\'{n} dodawania $\mathrm{i}$ odejmowania wynosi $\displaystyle \frac{1}{6}\cdot(2n^{3}+3n^{2}-5n)$

\begin{flushright}
{\it Zadanie}: Sprawdzić, że złożoność wynosi $O(n^{3})$
\end{flushright} 

\end{itemize}

\end{frame}
\begin{frame}{Gaussian elimination with backward substitution}
\begin{itemize}
\item \textbf{Macierz odwrotna} \newline
$A^{-1}$ : $Ax=Ib\rightarrow Ix=A_{-1}b$
\begin{flushright}
{\it Zadanie}: Ułóż algorytm
\end{flushright}
\item \textbf{Wyznacznik macierzy}
$\det A^{-1}(A=LU;\det A=\det L\cdot\det U,\ \cdots)$
\begin{flushright}
{\it Zadanie}: Sprawdzić
\end{flushright}
\item \textbf{Macierz Gaussa-Jordana}
$$
A'=\left(\begin{array}{llll}
a_{11}' & 0 & \cdots & 0\\
0 & a_{22}' & \cdots & 0\\
\vdots &  &  & \vdots\\
 0 & \cdots & 0 & a_{nn}'
\end{array}\right)
$$
\begin{flushright}
{\it Zadanie}: Sprawdzić złożoność, algorytm
\end{flushright}
\item \textbf{Unikniecie destrukcj}
$A,  b\rightarrow$?
\end{itemize}
\end{frame}
\begin{frame}{ O wyborze elementów podstawowych - pivots}
\begin{flushright}
{\it Zadanie}: Przypomnieć normy wektorów $\mathrm{i}$ macierzy
\end{flushright}
$$
\left(\begin{array}{lll}
10 & -7 & 0\\
-3 & 2.009 & 6\\
5 & -1 & 5
\end{array}\right)\ \cdot
\left(\begin{array}{l}
x_{1}\\
x_{2}\\
x_{3}
\end{array}\right)=\left(\begin{array}{l}
7\\
3.901\\
6
\end{array}\right)\ 
\begin{array}{l}
(:10)\\
(\cdot(-3))\\
(\cdot(-5))
\end{array}
$$
rozwiązanie:
$$
\alpha=\left(\begin{array}{l}
0\\
-1\\
1
\end{array}\right)
$$
Obliczenia: arytmetyka {\it fl} $\mathrm{z} 5$-cioma cyframi znaczącymi.
$$
\left(\begin{array}{lll}
10 & -7 & 0\\
0 & -0.001 & 6\\
0 & 2.5 & 5
\end{array}\right)\ \cdot
\left(\begin{array}{l}
x_{1}\\
x_{2}\\
x_{3}
\end{array}\right)=\left(\begin{array}{l}
7\\
6.001\\
2.5
\end{array}\right)\ 
\begin{array}{l}
\\
(:-0.001)
\\
\\
\end{array}
$$
\fbox{$-0.001$}
 -bardzo mały w porównaniu z pozostałymi $\rightarrow$eliminacja bez przestawienia

\end{frame}
\begin{frame}{ O wyborze elementów podstawowych - pivots}
Równanie 3) :
\begin{center}
6.001$\cdot$ 2.5$\cdot 10^{3}=\underbrace{1.5002}5\cdot 10^{4} \approx 1.5002\cdot 10^{4}$
$$
\underbrace{(6\cdot 2.5\cdot 10^{3}+5)}_{15005}\cdot x_{3}=1.5002\cdot 10^{4}+2.5
$$
$$
15005\cdot\ x_{3}=15004\rightarrow x_{3}=\frac{15004}{15005}=0.99993
$$
\end{center}
Prawdziwe $x_{3}=1$-błąd wydaje się mały!
\newline
Ale z równania 2) :
$$
-0.001\cdot x_{2}+6\cdot 0.99993=6.001
$$
$$
x_{2}=\frac{6.001-5.9995}{0.001}=\underline{-1.5}
$$
\end{frame}
\begin{frame}{ O wyborze elementów podstawowych - pivots}
Z równania 1) :
$$
10\cdot\ x_{1}+(-7)\cdot(-1.5)+0=7\rightarrow x_{1}=\underline{-0.35}
$$
Zamiast (0,-1,1) mamy $(-0.35,\ -1.5,0.99993)$ - Dlaczego? \newline 
Przecież nie było akumulacji błędów np. $10^{3}$ operacji, a macierz nie jest bliska osobliwej.
\begin{alertblock}{}
Powodem błędu jest zbyt mały element wiodący (pivot). Poszczególne wiersze dzielimy przez niego, a błędy zaokrągleń małe w porównaniu z nim są duże w stosunku do współczynników oryginalnej macierzy!
\end{alertblock}
\begin{flushright}
\textit{Zadanie}: Sprawdzić co będzie po zamianie 2) i 3) 
\end{flushright}
\end{frame}
\begin{frame}{ O wyborze elementów podstawowych - pivots}

Ogólna zasada: jeżeli w poszczególnych krokach mnożymy przez liczbę mniejszą lub równą 1, to możemy oczekiwać rozwiązania dokładnego.
\begin{exampleblock}{Partial pivoting:}
W $\mathrm{k}$-tym kroku wybieramy wiersz o największym współczynniku w nieredukowalnej części w $\mathrm{k}$-tej kolumnie

\end{exampleblock}

\begin{exampleblock}{Skalowanie -równoważenie (equalibration) macierzy}
Maksymalne elementy w każdej kolumnie i każdym wierszu-tego samego rzędu
\end{exampleblock}

\end{frame}
\begin{frame}{ O wyborze elementów podstawowych - pivots}

Np. Macierz $A$ można zrównoważyć na dwa sposoby:

$$A=\left(\begin{array}{lll}
1 & 1 & 1\\
10^{9} & -1 & 1\\
10^{9} & 1 & 0
\end{array}\right)
$$
$$
B=\left(\begin{array}{lll}
10^{-9} & 1 & 1\\
1 & -1 & 1\\
1 & 1 & 0
\end{array}\right)
$$
$$
C=\left(\begin{array}{lll}
1 & 1 & 1\\
1 & -10^{-9} & -10^{-9}\\
1 & -10^{-9} & 0
\end{array}\right)
$$

Macierz $B$ zachowanie poprawne

Macierz $C$ da macierz osobliwą na maszynie o mniej niż $ 9$-ciu cyfrach znaczących

\end{frame}

